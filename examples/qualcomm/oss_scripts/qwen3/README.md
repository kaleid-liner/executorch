TODO: refactor qwen3, llama and bitnet
